{% extends 'guide_base.html' %}
{% block navigation %}
{% include 'navigation_userinfo.html' %}
{% endblock %}
{% block css %}
        <link href="/static/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
{% endblock %}
{% block script %}
        <script src="/static/js/fileinput.js" type="text/javascript"></script>
        <script src="/static/js/fileinput_locale_fr.js" type="text/javascript"></script>
        <script src="/static/js/fileinput_locale_es.js" type="text/javascript"></script>
        <script src="/static/js/fileinput_locale_zh.js" type="text/javascript"></script>
<script>
$(document).on('ready', function() {
    initFileInput("file-Portrait", "/userinfo/");
    initPortrait("file-Portrait");
    $('#file-Portrait').fileinput('upload');
});
//初始化fileinput控件（第一次初始化）
function initFileInput(ctrlName, uploadUrl) {
    var control = $('#' + ctrlName);
    control.fileinput({
        language: 'zh', //设置语言
        uploadUrl: uploadUrl, //上传的地址
        allowedFileExtensions : ['jpg', 'png','gif'],//接收的文件后缀
        //showUpload: false, //是否显示上传按钮
        showRemove: false,
        showCaption: false,//是否显示标题
        browseClass: "btn btn-primary", //按钮样式
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>",
        //maxImageWidth: 200,
        //maxImageHeight: 200,
        //resizePreference: 'width'
    });
}
//初始化预览图片的设置
function initPortrait(ctrlName) {
        var control = $('#' + ctrlName);
        var imageurl = '{{ user.userinformation.photo_url }}';
        //重要，需要更新控件的附加参数内容，以及图片初始化显示
        control.fileinput('refresh', {
            uploadExtraData: {},
            initialPreview: [ //预览图片的设置
                "<img src='" + imageurl + "' class='file-preview-image' alt='肖像图片' title='肖像图片'>",
            ],
        });
    }
$('#file-Portrait').on('fileuploaded', function(event, data, previewId, index) {
    var form = data.form, files = data.files, extra = data.extra,
        response = data.response, reader = data.reader;
    console.log('File uploaded triggered');
});
</script>
{% endblock %}
{% block content %}
<div class="row">
    <div class="col-sm-6 col-sm-offset-3">
        <input id="file-Portrait" name="input4[]" type="file" multiple class="file-loading">
    </div>
</div>
{% endblock %}